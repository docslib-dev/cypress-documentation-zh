---
title: 'Microsoft Teams 集成'
description: '为您的 Cypress Cloud 组织和项目设置 Microsoft Teams 通知。'
sidebar_position: 60
sidebar_label: Microsoft Teams
---

<ProductHeading product="cloud" />

# Microsoft Teams 集成

:::info

##### <Icon name="question-circle" color="#4BBFD2" /> 您将学习到

- 如何启用 Cypress 与 Microsoft Teams 的集成
- 如何为 Cypress Cloud 组织和项目配置 Microsoft Teams 通知
- 如何在组织和项目级别管理 Microsoft Teams 通知

:::

Microsoft Teams 集成允许您直接在 Microsoft Teams 频道中查看 Cypress 测试结果。

<DocsImage
  src="/img/cloud/integrations/teams/ms-teams.png"
  alt="Microsoft Teams 频道中的 Cypress 通知信息流"
  width={800}
/>

## 启用 Microsoft Teams 集成

:::caution

<strong>所有权要求</strong>

要启用 Cypress 与 Microsoft Teams 的集成，您必须是 Cypress Cloud 组织和 Microsoft Teams 工作区的管理员或所有者。

:::

### 按组织配置（所有项目）

1. 访问 Cypress Cloud 的[组织页面](https://cloud.cypress.io/organizations)或打开组织切换器。
2. 选择您希望与 Microsoft Teams 集成的组织。

   <DocsImage
     src="/img/cloud/organizations/select-cypress-organization.jpg"
     alt="选择一个组织"
     width={500}
   />

3. 通过侧边导航栏访问所选组织的**集成**页面。

   <DocsImage
     src="/img/cloud/organizations/navigate-to-organization-integrations.jpg"
     alt="从集成中安装 Cypress Microsoft Teams"
     width={500}
   />

4. 在 Microsoft Teams 部分点击**启用**按钮。

   <DocsImage
     src="/img/cloud/integrations/teams/enable-teams-integration.jpg"
     alt="在 Microsoft Teams 集成下点击启用"
     width={1000}
   />

5. 您将跳转到一个管理 Webhook 的窗口，这是 Cypress Cloud 与 Microsoft Teams 通信的方式。首先，您需要为 Teams 频道配置一个_传入 Webhook_。

   在 Microsoft Teams 中：

   - 打开您要添加 Webhook 的频道，从右上角选择**•••**。
   - 从下拉菜单中选择 Connectors。

     <DocsImage
       src="/img/cloud/integrations/teams/teams-connectors.png"
       alt="访问项目设置"
       width={300}
     />

   - 搜索 Incoming Webhook 并选择 Configure。提供名称，并根据需要上传 Webhook 的图像。

     <DocsImage
       src="/img/cloud/integrations/teams/teams-configure.png"
       alt="访问项目设置"
       width={500}
     />

   - 复制并保存对话框中显示的唯一 Webhook URL。该 URL 映射到频道，可用于向 Teams 发送信息。
   - 选择**Done**。

     <DocsImage
       src="/img/cloud/integrations/teams/teams-url.png"
       alt="访问项目设置"
       width={500}
     />

     Webhook 现在已在 Teams 频道中可用。更多信息，请参阅
     [Microsoft Teams - 创建传入 Webhook](https://learn.microsoft.com/en-us/microsoftteams/platform/webhooks-and-connectors/how-to/add-incoming-webhook?tabs=dotnet#create-incoming-webhooks-1)。

6. 然后，将 Teams Webhook 添加到您的 Cypress Cloud 组织。

   在 Cypress Cloud 中：

   - 粘贴 Teams Webhook URL，选择您的团队应接收的通知类型。

     <DocsImage
       src="/img/cloud/integrations/teams/add-teams-webhook.jpg"
       alt="在 Microsoft Teams 集成下点击启用"
       width={450}
     />

   配置并添加 Webhook 后，安装即完成！Cypress Cloud 会将您组织中**所有**项目的运行结果发布到指定的 Microsoft Teams 频道。

#### 移除 Webhook

您可以停止 Cypress Cloud 向某个频道发布通知。您无法从项目中删除全局通知频道。

1. 导航到已安装集成的项目的**集成**页面。
2. 滚动到**Microsoft Teams**部分。
3. 在**操作**下，为每个要删除的 Webhook 选择**删除**。

### 按项目配置

如果您的组织有多个团队在独立项目上工作，您可以根据团队的需求为每个项目定制 Microsoft Teams 通知。您可以让 Cypress Cloud 为特定项目发布运行结果。

1. 在组织切换器中选择您的组织。
   <DocsImage
     src="/img/cloud/organizations/select-cypress-organization.jpg"
     alt="选择一个组织"
     width={500}
   />
2. 选择您希望与 Microsoft Teams 集成的项目。
   <DocsImage
     src="/img/cloud/projects/select-cypress-project.jpg"
     alt="选择一个项目"
     width={600}
   />
3. 转到项目的设置页面。
   <DocsImage
     src="/img/cloud/projects/select-project-settings.jpg"
     alt="访问项目设置"
     width={400}
   />
4. 滚动到底部，在**Microsoft Teams**部分点击**添加 Teams Webhook**。
5. 您将跳转到一个管理 Webhook 的窗口，这是 Cypress Cloud 与 Microsoft Teams 通信的方式。首先，您需要为 Teams 频道配置一个_传入 Webhook_。

   在 Microsoft Teams 中：

   - 打开您要添加 Webhook 的频道，从右上角选择**•••**。
   - 从下拉菜单中选择 Connectors。

     <DocsImage
       src="/img/cloud/integrations/teams/teams-connectors.png"
       alt="打开频道菜单并选择 Connectors"
       width={300}
     />

   - 搜索 Incoming Webhook 并选择 Configure。提供名称，并根据需要上传 Webhook 的图像。

     <DocsImage
       src="/img/cloud/integrations/teams/teams-configure.png"
       alt="点击配置传入 Webhook"
       width={500}
     />

   - 复制并保存对话框中显示的唯一 Webhook URL。该 URL 映射到频道，可用于向 Teams 发送信息。
   - 选择**Done**。

     <DocsImage
       src="/img/cloud/integrations/teams/teams-url.png"
       alt="复制 URL 并点击 Done"
       width={500}
     />

     Webhook 现在已在 Teams 频道中可用。更多信息，请参阅
     [Microsoft Teams - 创建传入 Webhook](https://learn.microsoft.com/en-us/microsoftteams/platform/webhooks-and-connectors/how-to/add-incoming-webhook?tabs=dotnet#create-incoming-webhooks-1)。

6. 然后，将 Teams Webhook 添加到您的 Cypress Cloud 项目。

   在 Cypress Cloud 中：

   - 粘贴 Teams Webhook URL，选择您的团队应接收的通知类型。

     <DocsImage
       src="/img/cloud/integrations/teams/add-teams-webhook.jpg"
       alt="粘贴 Teams Webhook URL"
       width={450}
     />

   配置并添加 Webhook 后，安装即完成！Cypress Cloud 会将**此**项目的运行结果发布到指定的 Microsoft Teams 频道。

## 通知偏好设置

默认情况下，Cypress Cloud 只会为失败的运行向每个配置的频道发布 Teams 消息。但是，您可以选择以下任意组合的偏好设置：

- **失败的运行**：会在运行状态为_失败_时通知。
- **通过的运行**：会在运行状态为_通过_时通知。
- **不稳定的测试**：会在运行中识别出_不稳定_测试时通知。

设置通知偏好：

1. 导航到 Teams 配置页面
2. 为每个频道选择通知偏好

### 按标签或运行组过滤通知

在项目级别配置时，您可以根据运行记录时使用的[标签](/app/references/command-line#cypress-run-tag-lt-tag-gt)或[组](/app/references/command-line#cypress-run-group-lt-name-gt)过滤发布到 Teams 的通知。这有助于仅在某些运行（如暂存或发布环境）时发布通知。

1. 导航到**Teams**配置页面
2. 在**标签**下，为所需的集成选择**标签**下拉菜单，并选择要过滤的标签。如果选择了多个标签，只要运行关联了其中任何一个标签，Teams 消息就会被发送。
3. 在**运行组**下，为所需的集成选择**运行组**下拉菜单，并选择要过滤的运行组。如果选择了多个运行组，只要运行关联了其中任何一个运行组，Teams 消息就会被发送。

如果同时选择了标签和运行组，只有同时满足这两个条件的运行才会触发向 Teams 发送消息。

### 静音频道

如果您希望 Cypress Cloud 暂时停止向某个频道发布 Teams 消息，您可以**静音**该频道。这允许您轻松暂停和恢复特定频道的通知，而不会丢失已配置的设置。

1. 导航到**Teams**配置页面
2. 为每个要静音的 Teams 频道切换**活跃**选择器。